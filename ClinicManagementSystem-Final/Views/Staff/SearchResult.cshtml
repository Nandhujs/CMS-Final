@model StaffViewModel

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

<div class="container mt-5 p-4 shadow rounded" style="max-width: 700px; background-color:#f8f9fa;">
    <h2 class="text-primary mb-4">Staff Details & Edit</h2>

    <form asp-action="UpdateStaff" method="post">
        <input type="hidden" asp-for="Staff.StaffId" />

        <div class="mb-3">
            <label asp-for="Staff.Name" class="form-label">Name</label>
            <input asp-for="Staff.Name" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Staff.Email" class="form-label">Email</label>
            <input asp-for="Staff.Email" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Staff.DOB" class="form-label">Date of Birth</label>
            <input asp-for="Staff.DOB" type="date" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Staff.DOJ" class="form-label">Date of Joining</label>
            <input asp-for="Staff.DOJ" type="date" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Staff.Address" class="form-label">Address</label>
            <input asp-for="Staff.Address" class="form-control" />
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Staff.Gender" class="form-label">Gender</label>
                <select asp-for="Staff.Gender" class="form-select">
                    <option value="">Select Gender</option>
                    <option>Male</option>
                    <option>Female</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Staff.Phone" class="form-label">Phone</label>
                <input asp-for="Staff.Phone" class="form-control" />
            </div>
        </div>

        <div class="mb-3">
            <label asp-for="Staff.RoleId" class="form-label">Role</label>
            <select asp-for="Staff.RoleId" asp-items="@(new SelectList(Model.Roles, "RoleId", "RoleName"))" id="RoleIdDropdown" class="form-select"></select>
        </div>

        <div id="doctorFields" class="p-3 border rounded bg-light mb-3" style="display:none;">
            <h5 class="text-secondary mb-3">Doctor Details</h5>

            <div class="mb-3">
                <label asp-for="SelectedSpecializationId" class="form-label">Specialization</label>
                <select asp-for="SelectedSpecializationId" class="form-select" asp-items="@(new SelectList(Model.Specializations, "SpecializationId", "Name"))">
                    <option value="">-- Select Specialization --</option>
                </select>

            </div>

            <div class="mb-3">
                <label asp-for="Fee" class="form-label">Consultation Fee</label>
                <input asp-for="Fee" type="number" step="0.01" class="form-control" />
            </div>
        </div>

        <div class="text-center">
            <button type="submit" class="btn btn-success px-4">Save Changes</button>
            <a asp-action="Search" class="btn btn-secondary px-4 ms-2">Back</a>
        </div>
    </form>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function toggleDoctorFields() {
            var selectedRoleId = $('#RoleIdDropdown').val();
            var doctorRoleId = '@Model.Roles.FirstOrDefault(r => r.RoleName.ToLower() == "doctor")?.RoleId ?? 2';

            if (selectedRoleId == doctorRoleId) {
                $('#doctorFields').slideDown();
            } else {
                $('#doctorFields').slideUp();
            }
        }

        $(document).ready(function () {
            $('#RoleIdDropdown').change(toggleDoctorFields);
            toggleDoctorFields();
        });
    </script>
}
